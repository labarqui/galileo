SHELL = /bin/sh
TARGET_BIN    = helloworld
TARGET_ARCH   = -m32 -march=i586 --sysroot=/opt/cross/i586-poky-linux-uclibc-x-tools
INCLUDE_DIRS  = -I $(TOOLDIR)../include \
				-I $(TOOLDIR)../include/c++ \
				-I $(TOOLDIR)../lib/i586-poky-linux-uclibc/gcc/i586-poky-linux-uclibc/4.7.2/include 
LIBRARY_DIRS  = -L $(TOOLDIR)../../lib \
				-L $(TOOLDIR)../lib \
				-L $(TOOLDIR)../lib/i586-poky-linux-uclibc/4.7.2 \
				-L $(TOOLDIR)../lib/i586-poky-linux-uclibc/4.7.2 
COMPILE_OPTS  = -O2 -pipe -g -feliminate-unused-debug-types -fpermissive -Wall $(INCLUDE_DIRS) 

TOOLDIR = /opt/cross/i586-poky-linux-uclibc-x-tools/usr/bin/i586-poky-linux-uclibc/
CC      = $(TOOLDIR)i586-poky-linux-uclibc-g++
CXX     = $(CC)
AS      = $(CC)
LD      = $(CC)
AR      = $(TOOLDIR)i586-poky-linux-uclibc-ar
CFLAGS  = $(COMPILE_OPTS)
CXXFLAGS= $(COMPILE_OPTS)
LDFLAGS = -Wl,-O1 -Wl,--hash-style=gnu -Wl,--as-needed $(LIBRARY_DIRS) -lstdc++

all: target

target: $(patsubst %.c,%.o,$(wildcard *.c)) $(patsubst %.cpp,%.o,$(wildcard *.cpp)) 
	$(LD) $(LDFLAGS) $(TARGET_ARCH) $^ -o $(TARGET_BIN)

clean:
	rm -f $(TARGET_BIN) *.o
